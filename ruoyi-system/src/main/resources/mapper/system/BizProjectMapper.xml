<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
		PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
		"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ruoyi.system.mapper.BizProjectMapper">

	<resultMap type="BizProject" id="BizProjectResult">
		<result property="id"    column="id"    />
		<result property="projectName"    column="project_name"    />
		<result property="computePower"    column="compute_power"    />
		<result property="powerConsumption"    column="power_consumption"    />
		<result property="unitPrice"    column="unit_price"    />
		<result property="minPurchase"    column="min_purchase"    />
		<result property="waitingPeriod"    column="waiting_period"    />
		<result property="incomeCycle"    column="income_cycle"    />
		<result property="status"    column="status"    />
		<result property="delFlag"    column="del_flag"    />
		<result property="createBy"    column="create_by"    />
		<result property="createTime"    column="create_time"    />
		<result property="updateBy"    column="update_by"    />
		<result property="updateTime"    column="update_time"    />
		<result property="remark"    column="remark"    />
		<result property="sort"    column="sort"    />
	</resultMap>


	<!-- 项目多语言关联查询结果映射 -->
	<resultMap id="ProjectVoResult" type="projectVo">
		<!-- 项目基础字段 -->
		<result property="id" column="id"/>
		<result property="projectName" column="project_name"/>
		<result property="computePower" column="compute_power"/>
		<result property="powerConsumption" column="power_consumption"/>
		<result property="unitPrice" column="unit_price"/>
		<result property="minPurchase" column="min_purchase"/>
		<result property="waitingPeriod" column="waiting_period"/>
		<result property="incomeCycle" column="income_cycle"/>
		<result property="createTime" column="create_time"/>

		<!-- 多语言字段 -->
		<result property="intro" column="intro"/>
		<result property="description" column="description"/>
	</resultMap>

	<sql id="selectBizProjectVo">
		select id, project_name, compute_power, power_consumption, unit_price, min_purchase, waiting_period, income_cycle, status, del_flag, create_by, create_time, update_by, update_time, remark, sort from biz_project
	</sql>

	<sql id="selectProjectVo">
		SELECT
			p.id,
			p.project_name,
			p.compute_power,
			p.power_consumption,
			p.unit_price,
			p.min_purchase,
			p.waiting_period,
			p.income_cycle,
			i.intro,
			i.description,
			p.create_time
		FROM biz_project p
		LEFT JOIN biz_project_i18n i ON p.id = i.project_id
		AND i.lang_code = #{params.langCode}
	</sql>

	<select id="selectBizProjectList" parameterType="BizProject" resultMap="BizProjectResult">
		<include refid="selectBizProjectVo"/>
		<where>
			<if test="projectName != null  and projectName != ''"> and project_name like concat('%', #{projectName}, '%')</if>
			<if test="computePower != null "> and compute_power = #{computePower}</if>
			<if test="powerConsumption != null "> and power_consumption = #{powerConsumption}</if>
			<if test="unitPrice != null "> and unit_price = #{unitPrice}</if>
			<if test="minPurchase != null "> and min_purchase = #{minPurchase}</if>
			<if test="waitingPeriod != null "> and waiting_period = #{waitingPeriod}</if>
			<if test="incomeCycle != null "> and income_cycle = #{incomeCycle}</if>
			<if test="status != null  and status != ''"> and status = #{status}</if>
			and del_flag = '0'
		</where>
		order by sort
	</select>

	<select id="selectBizProjectById" parameterType="Long" resultMap="BizProjectResult">
		<include refid="selectBizProjectVo"/>
		where id = #{id}
	</select>

	<select id="selectProjectVoList" parameterType="BizProject" resultMap="ProjectVoResult">
		<include refid="selectProjectVo"/>
		<where>
			<if test="projectName != null  and p.projectName != ''"> and p.project_name like concat('%', #{projectName}, '%')</if>
			<if test="computePower != null "> and p.compute_power = #{computePower}</if>
			<if test="powerConsumption != null "> and p.power_consumption = #{powerConsumption}</if>
			<if test="unitPrice != null "> and p.unit_price = #{unitPrice}</if>
			<if test="minPurchase != null "> and p.min_purchase = #{minPurchase}</if>
			<if test="waitingPeriod != null "> and p.waiting_period = #{waitingPeriod}</if>
			<if test="incomeCycle != null "> and p.income_cycle = #{incomeCycle}</if>
			<if test="status != null  and status != ''"> and p.status = #{status}</if>
			 and del_flag = '0'
		</where>
		order by p.sort
	</select>

	<insert id="insertBizProject" parameterType="BizProject" useGeneratedKeys="true" keyProperty="id">
		insert into biz_project
		<trim prefix="(" suffix=")" suffixOverrides=",">
			<if test="projectName != null and projectName != ''">project_name,</if>
			<if test="computePower != null">compute_power,</if>
			<if test="powerConsumption != null">power_consumption,</if>
			<if test="unitPrice != null">unit_price,</if>
			<if test="minPurchase != null">min_purchase,</if>
			<if test="waitingPeriod != null">waiting_period,</if>
			<if test="incomeCycle != null">income_cycle,</if>
			<if test="status != null and status != ''">status,</if>
			<if test="delFlag != null">del_flag,</if>
			<if test="createBy != null">create_by,</if>
			<if test="createTime != null">create_time,</if>
			<if test="updateBy != null">update_by,</if>
			<if test="updateTime != null">update_time,</if>
			<if test="remark != null">remark,</if>
			<if test="sort != null">sort,</if>
		</trim>
		<trim prefix="values (" suffix=")" suffixOverrides=",">
			<if test="projectName != null and projectName != ''">#{projectName},</if>
			<if test="computePower != null">#{computePower},</if>
			<if test="powerConsumption != null">#{powerConsumption},</if>
			<if test="unitPrice != null">#{unitPrice},</if>
			<if test="minPurchase != null">#{minPurchase},</if>
			<if test="waitingPeriod != null">#{waitingPeriod},</if>
			<if test="incomeCycle != null">#{incomeCycle},</if>
			<if test="status != null and status != ''">#{status},</if>
			<if test="delFlag != null">#{delFlag},</if>
			<if test="createBy != null">#{createBy},</if>
			<if test="createTime != null">#{createTime},</if>
			<if test="updateBy != null">#{updateBy},</if>
			<if test="updateTime != null">#{updateTime},</if>
			<if test="remark != null">#{remark},</if>
			<if test="sort != null">#{sort},</if>
		</trim>
	</insert>

	<update id="updateBizProject" parameterType="BizProject">
		update biz_project
		<trim prefix="SET" suffixOverrides=",">
			<if test="projectName != null and projectName != ''">project_name = #{projectName},</if>
			<if test="computePower != null">compute_power = #{computePower},</if>
			<if test="powerConsumption != null">power_consumption = #{powerConsumption},</if>
			<if test="unitPrice != null">unit_price = #{unitPrice},</if>
			<if test="minPurchase != null">min_purchase = #{minPurchase},</if>
			<if test="waitingPeriod != null">waiting_period = #{waitingPeriod},</if>
			<if test="incomeCycle != null">income_cycle = #{incomeCycle},</if>
			<if test="status != null and status != ''">status = #{status},</if>
			<if test="delFlag != null">del_flag = #{delFlag},</if>
			<if test="createBy != null">create_by = #{createBy},</if>
			<if test="createTime != null">create_time = #{createTime},</if>
			<if test="updateBy != null">update_by = #{updateBy},</if>
			<if test="updateTime != null">update_time = #{updateTime},</if>
			<if test="remark != null">remark = #{remark},</if>
			<if test="sort != null">sort = #{sort},</if>
		</trim>
		where id = #{id}
	</update>

	<delete id="deleteBizProjectById" parameterType="Long">
		delete from biz_project where id = #{id}
	</delete>

	<delete id="deleteBizProjectByIds" parameterType="String">
		delete from biz_project where id in
		<foreach item="id" collection="array" open="(" separator="," close=")">
			#{id}
		</foreach>
	</delete>
</mapper>
